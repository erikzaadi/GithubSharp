var UrlHelper={Base:"",LoginURL:function(){return this.Base+"Home/Login"}};function InitMaster(a){UrlHelper.Base=a;$("#logindisplay a").live("click",LoginPopup);RemoveNotification();InitPopup()}function InitPopup(){var a=$("#blocker");$('<input type="button" id="CancelButton" value="Cancel" />').insertAfter("#blocker input[type='submit']");$("#CancelButton",a).click(function(){a.slideUp("fast");$(".overlayed").remove();return false})}
function RemoveNotification(){setTimeout(function(){$("#notification").fadeOut("slow")},3500)}
function LoginPopup(){var a=$("#blocker");$("form",a).submit(function(){$.post(UrlHelper.LoginURL(),$(this).serialize(),function(b){if(b)if(b.success){a.slideUp("fast");$(".overlayed").remove();$("#logindisplay").html(b.Name+' <a href="'+UrlHelper.LoginURL()+'">Change</a>');$("#notificationwrapper").html('<span class="notice" id="notification">Login succeeded</span>');RemoveNotification()}else $("#errormessage",a).html('<span class="error">'+b.message+"</span>")},"json");return false});$('<div class="overlayed" />').appendTo("body").fadeTo("slow",
0.4,function(){$(this).toggleClass("overlayedReady",true);a.slideDown("fast")});return false};
